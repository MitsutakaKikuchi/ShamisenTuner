ご回答ありがとうございます。頂戴した内容をもとに、三味線調弦アプリの「要件定義」および「基本設計」をまとめました。

画像につきましては、私は直接画像を生成する機能を持たないため、**テキストによるワイヤーフレーム（画面構成図）とUI/UXの詳細な設計イメージ**にて表現させていただきます。

---

# 三味線調弦アプリ 要件定義書

## 1. アプリの目的とターゲット

* **目的:** 三味線奏者が、指定した基音と調弦パターン（本調子・二上り・三下り）に基づき、純正律で正確に調弦を行うためのサポートツール。
* **ターゲット:** 三味線の初心者から上級者まで。自分の耳で音を合わせる練習をしたいユーザー（チューナー機能は非搭載）。
* **プラットフォーム:** iOS（iPhone）

## 2. 機能要件

1. **基音選択機能**
* A3（1本）からA4までの範囲を、半音単位で選択可能。


2. **ピッチ微調整機能**
* 選択した基音に対し、+1/4音、-1/4音、+1/2音、-1/2音などの微調整が可能。


3. **基準ピッチ（キャリブレーション）変更機能**
* デフォルトは A=440Hz。ユーザーが任意のHz数（例：442Hzなど）に変更可能。


4. **調弦パターン発音機能**
* 選択した基音を「一の糸」とし、調弦パターン（本調子、二上り、三下り）に応じた「二の糸」「三の糸」の音を鳴らす。
* 各糸の音高は、一の糸を基準とした**純正律**で計算する。


5. **音色選択機能**
* 電子音（正弦波など）に加え、「調子笛の音（サンプリング音源など）」を選択可能。


6. **自動再生（アルペジオ）機能**
* ONにすると、「一の糸 → 二の糸 → 三の糸」の順番で自動的かつループで音を鳴らし続ける。


7. **画面スリープ（自動ロック）防止機能**
* アプリ起動中、または音を鳴らしている間は、iPhoneの画面が暗くならないように制御する。



## 3. 非機能要件（品質・技術要件）

1. **ポップノイズの完全排除（最重要）**
* 音の再生開始・停止時に発生する「ブチッ」というノイズを防ぐため、音声波形の立ち上がり（Attack）と消え際（Release）にフェード処理（エンベロープ）を実装する。


2. **聴感上の音量バランス調整**
* 人間の耳の特性（等ラウドネス曲線）を考慮し、低い音（一の糸）と高い音（三の糸）が同じくらいの音量に聞こえるよう、プログラム内部で周波数帯に応じた音量（ゲイン）補正を行う。


3. **直感的なUI/UX**
* 演奏中・調弦中であっても、片手で迷わず操作できる大きめのボタンやダイヤル/スライダーを採用する。



---

# 基本設計書

## 1. システム・アーキテクチャ

* **開発言語 / フレームワーク:** Swift / SwiftUI
* **オーディオ処理:** `AVAudioEngine` を使用。
* 純音（正弦波）生成には `AVAudioSourceNode` を用い、DSP（デジタル信号処理）レベルで波形を生成。
* 調子笛の音色には `AVAudioUnitSampler` を用い、あらかじめ用意した音声ファイルをピッチシフトして再生。
* フェードイン・フェードアウト処理（ADSRエンベロープ）を実装し、ノイズを防止。



## 2. 純正律計算ロジック

基準となる一の糸の周波数を  とした場合、各調弦パターンにおける二の糸、三の糸の周波数は以下の計算式を厳密に適用する。

* **本調子:** 一の糸:  / 二の糸:  / 三の糸: 
* **二上り:** 一の糸:  / 二の糸:  / 三の糸: 
* **三下り:** 一の糸:  / 二の糸:  / 三の糸: 

※微調整（1/4上げ等）や基準ピッチ変更（442Hz等）が行われた場合は、まずそれらを加味して  の値を算出し、その後上記の比率を掛ける。

---

# UI/UX 設計イメージ（画面構成案）

画像をご提示いただいた元アプリの「和の雰囲気」を踏襲しつつ、iOSのモダンで直感的な操作性を組み合わせたレイアウト案です。

```text
+-----------------------------------------+
| [設定⚙️]                     [音色:調子笛🎵]| <- ヘッダー
|                                         |
|         【基準ピッチ: 440 Hz】 ±        | <- タップで調整
|                                         |
|      +---------------------------+      |
|      |        本 數 (基音)       |      |
|      |           [ 4 ]           |      | <- 大きなドラムロール式ピッカー
|      |            (C)            |      |    (A3〜A4を選択)
|      +---------------------------+      |
|                                         |
|       微調整:  -1/4  [ 0 ]  +1/4        | <- スライダー、またはステップボタン
|                                         |
| --------------------------------------- |
|                                         |
|      [ 本調子 ]  [ 二上り ]  [ 三下り ] | <- 調弦パターン選択タブ(大きく)
|                                         |
| --------------------------------------- |
|                                         |
|           自動再生(アルペジオ)          |
|               [ OFF / ON ]              | <- トグルスイッチ
|                                         |
|     +-------+   +-------+   +-------+   |
|     | 一の糸 |   | 二の糸 |   | 三の糸 |   | <- 各糸の再生ボタン
|     | (D)   |   | (G)   |   | (D)   |   |    タップで個別再生
|     |  ▶️   |   |  ▶️   |   |  ▶️   |   |    (再生中はハイライト)
|     +-------+   +-------+   +-------+   |
|                                         |
+-----------------------------------------+

```

### UI/UXのポイント

1. **直感的な基音選択:**
ご提示いただいた画像のような円形ダイヤルも魅力的ですが、片手での操作性や視認性を考慮し、iOS標準のピッカー（ドラムロール）を大きく中央に配置するか、左右のスワイプで数（本数）を切り替えるカルーセルUIが使いやすいです。
2. **状態の視覚化:**
現在どの音が鳴っているのか（一の糸なのか、二の糸なのか）を、ボタンの色を光らせる（ハイライトする）ことで視覚的に分かりやすくします。
3. **誤操作防止:**
微調整（1/4など）は頻繁に変えるものではないため、メインの基音選択よりも一段階小さなUI（セグメントコントロールやステップボタン）にします。

この要件定義と基本設計をベースに、開発を進めていく形になります。開発にあたり、Swiftでの具体的な `AVAudioEngine` の実装コード（ノイズを消す処理など）が必要な場合は、すぐにご提示できますのでお申し付けください。